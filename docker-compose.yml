services:
  rtmp:
    image: bluenviron/mediamtx:latest
    ports:
      - "1935:1935"
      - "8554:8554"
      - "8888:8888"

  emulator:
    build: ./emulator
    depends_on:
      - rtmp
    environment:
      - DISPLAY=:99
      - SDL_VIDEODRIVER=x11
      - SDL_AUDIODRIVER=dummy
      - RTMP_URL=rtmp://rtmp:1935/live/stream
    volumes:
      - ./roms:/roms:ro
    ports:
      - "55355:55355/udp"
      - "55400:55400/udp"
